(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{144:function(e,t,a){e.exports=a.p+"static/media/logo.f958e91a.png"},150:function(e,t,a){e.exports=a.p+"static/media/bike.b4758c72.svg"},225:function(e,t,a){e.exports=a(385)},385:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(25),i=a.n(c),l=a(13),o=a(39),u=a(78),m=a(152),s=a(77),d=a.n(s),g=a(21),f=a.n(g),p=a(42),h=a(144),E=a.n(h),b=Object(l.createStyles)({header:{display:"flex",alignItems:"center"},logo:{width:150,height:150,marginRight:24}}),y=Object(l.withStyles)(b)(function(e){var t=e.classes;return r.a.createElement("header",{className:t.header},r.a.createElement("a",{href:"/"},r.a.createElement("img",{src:E.a,alt:"Logo",className:t.logo})),r.a.createElement("div",null,r.a.createElement(p.a,{variant:"h3",gutterBottom:!0},"Police Department of Berlin"),r.a.createElement(p.a,{variant:"h5"},"Stolen Bikes")))}),j=Object(l.createStyles)({wrapper:{minWidth:800,maxWidth:1e3,margin:"0 auto",padding:20}}),v=Object(l.withStyles)(j)(function(e){var t=e.classes,a=e.children;return r.a.createElement("div",{className:t.wrapper},a)}),O=a(11),x=a(35),S=a.n(x),w=a(111),k=a(29),T=a.n(k),F=a(23),I=a.n(F),_=a(52),C=a.n(_),N=function(e){return new Date(1e3*e).toLocaleString([],{minute:"numeric",year:"numeric",month:"long",day:"numeric",hour:"numeric"})},D=Object(l.withStyles)(function(e){return Object(l.createStyles)({cardContent:{flex:"auto",display:"flex",flexDirection:"column",padding:2*e.spacing.unit},cardFooter:{marginTop:"auto",alignSelf:"flex-end",fontStyle:"italic"}})})(function(e){var t=e.incident,a=e.withLink,n=e.classes;return r.a.createElement("div",{className:n.cardContent},a?r.a.createElement(C.a,{component:function(e){return r.a.createElement(o.b,Object.assign({to:"/case/".concat(t.id)},e))},variant:"h6",gutterBottom:!0},t.title):r.a.createElement(I.a,{variant:"h6",gutterBottom:!0},t.title||"Loading..."),r.a.createElement(I.a,{variant:"body1",gutterBottom:!0},t.description||"No description"),r.a.createElement(I.a,{variant:"body1",gutterBottom:!0},t.occurred_at&&t.address?"".concat(N(t.occurred_at)," \u2014 ").concat(t.address):"..."),r.a.createElement(I.a,{variant:"caption",className:n.cardFooter},t.updated_at?"Reported: ".concat(N(t.updated_at)):"..."))}),P="https://bikewise.org:443/api/v2",L=(a(307),function(e){var t=e.incidentId,a=Object(n.useState)({title:"Loading..."}),c=Object(O.a)(a,2),i=c[0],l=c[1],o=Object(n.useState)({}),u=Object(O.a)(o,2),m=u[0],s=u[1],d=Object(n.useState)({}),g=Object(O.a)(d,2),f=g[0],p=g[1];return Object(n.useEffect)(function(){fetch("".concat(P,"/incidents/").concat(t)).then(function(e){return e.json()}).then(function(e){var t=e.incident;return l(t),fetch("".concat(P,"/locations?").concat(T.a.stringify({occurred_before:t.occurred_at,occurred_after:t.occurred_at,incident_type:"theft",query:t.title})))}).then(function(e){return e.json()}).then(function(e){return e.features[0].geometry.coordinates}).then(function(e){s({zoom:10,longitude:e[0],latitude:e[1]}),p({longitude:e[0],latitude:e[1]})})},[]),r.a.createElement(S.a,null,r.a.createElement(D,{incident:i}),m.latitude&&m.longitude&&f.latitude&&f.longitude?r.a.createElement(w.b,Object.assign({mapStyle:"mapbox://styles/mapbox/streets-v11",width:"100%",height:400,mapboxApiAccessToken:"pk.eyJ1IjoieWFraGludmFkaW0iLCJhIjoiY2p0eDJ2bDk3MmVleDRkbXN3bjV2enk4ZyJ9.UuTPJrkGfk0WrX59JPHu8w",onViewportChange:function(e){return s(e)}},m),r.a.createElement(w.a,{latitude:f.latitude,longitude:f.longitude,offsetLeft:-6,offsetTop:-11},r.a.createElement("div",null,"\ud83d\udccd"))):r.a.createElement("div",{style:{height:400,backgroundColor:"#EFE9E1"}}))}),B=function(e){var t=e.match;return r.a.createElement(v,null,r.a.createElement(f.a,{container:!0,spacing:24},r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(y,null)),r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(L,{incidentId:t.params.id}))))},Q=a(148),J=a(36),W=a(53),M=a.n(W),V=a(31),q=a.n(V),A=a(386),G=function(){var e=T.a.parse(location.search),t="string"===typeof e.page?parseInt(e.page):1,a="string"===typeof e.dateFrom?Object(A.a)(parseInt(e.dateFrom)):null,n="string"===typeof e.dateTo?Object(A.a)(parseInt(e.dateTo)):null;return{urlTextQuery:"string"===typeof e.textQuery?e.textQuery:"",urlDateFrom:a,urlDateTo:n,urlPage:t}},R=a(387),z=function(e){var t=e.dateFrom,a=e.dateTo,n=e.textQuery,r={};return t&&(r.dateFrom=Object(R.a)(t).toString()),a&&(r.dateTo=Object(R.a)(a).toString()),n&&(r.textQuery=n),T.a.stringify(r)},H=Object(l.createStyles)({datePicker:{minHeight:80},button:{marginTop:12}}),X=Object(l.withStyles)(H)(Object(J.e)(function(e){var t=e.history,a=e.classes,c=G(),i=c.urlTextQuery,l=c.urlDateFrom,o=c.urlDateTo,m=Object(n.useState)(i),s=Object(O.a)(m,2),d=s[0],g=s[1],p=Object(n.useState)(l),h=Object(O.a)(p,2),E=h[0],b=h[1],y=Object(n.useState)(o),j=Object(O.a)(y,2),v=j[0],x=j[1],S=function(e){var t=e.value,n=e.onChange,c=Object(Q.a)(e,["value","onChange"]);return r.a.createElement(u.a,Object.assign({clearable:!0,autoOk:!0,disableFuture:!0,keyboard:!0,className:a.datePicker,format:"dd.MM.yyyy",mask:function(e){return e?[/\d/,/\d/,".",/\d/,/\d/,".",/\d/,/\d/,/\d/,/\d/]:[]},value:t,onChange:n},c))};return r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),i===d&&l===E&&o===v||t.push("/?".concat(z({textQuery:d,dateFrom:E,dateTo:v})))}},r.a.createElement(f.a,{container:!0,spacing:24,alignItems:"flex-start",justify:"space-between"},r.a.createElement(f.a,{item:!0,xs:4},r.a.createElement(M.a,{id:"text-query",label:"Search case descriptions",value:d,onChange:function(e){g(e.target.value)},placeholder:"Cannondale",fullWidth:!0})),r.a.createElement(f.a,{item:!0,xs:!0},r.a.createElement(S,{value:E,onChange:b,label:"From",placeholder:"31.12.2017",maxDate:v})),r.a.createElement(f.a,{item:!0,xs:!0},r.a.createElement(S,{value:v,onChange:x,label:"To",placeholder:"31.12.2018",minDate:E})),r.a.createElement(f.a,{item:!0,xs:!0},r.a.createElement(q.a,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,className:a.button},"Find Cases"))))})),Y=a(63),U=a(150),Z=a.n(U),K=Object(l.withStyles)(function(e){return Object(l.createStyles)({imageContainer:{width:200,height:200,flex:"none",backgroundImage:"url(".concat(Z.a,")"),backgroundSize:200},image:{height:"100%"},card:{display:"flex"}})})(function(e){var t=e.incident,a=e.classes;return r.a.createElement(S.a,{className:a.card},r.a.createElement("div",{className:a.imageContainer},t.media.image_url_thumb&&r.a.createElement("img",{src:t.media.image_url_thumb,className:a.image})),r.a.createElement(D,{incident:t,withLink:!0}))}),$=a(151),ee=a.n($),te=function(){var e=Object(n.useState)(null),t=Object(O.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(null),i=Object(O.a)(c,2),l=i[0],o=i[1],u=Object(n.useState)(null),m=Object(O.a)(u,2),s=m[0],d=m[1],g=T.a.parse(location.search),f=G().urlPage;return Object(n.useEffect)(function(){var e={incident_type:"theft",proximity:"London",query:g.textQuery,occurred_after:g.dateFrom,occurred_before:g.dateTo},t=Object(Y.a)({},e,{per_page:10,page:f}),a=Object(Y.a)({},e,{per_page:1e6,page:1}),n=function(e){return fetch("".concat(P,"/incidents?").concat(T.a.stringify(e))).then(function(e){return e.json()}).then(function(e){return e.incidents}).catch(d)};r(null),o(null),d(null),n(t).then(r),n(a).then(o)},[g.textQuery,g.dateFrom,g.dateTo]),Object(n.useEffect)(function(){l&&l.length&&r(l.slice(10*(f-1),10*f))},[f,l]),{pageIncidents:a,setPageIncidents:r,allIncidents:l,setAllIncidents:o,error:s}},ae=Object(J.e)(function(e){var t=e.location,a=e.history,n=te(),c=n.pageIncidents,i=n.allIncidents,l=n.error,o=function(e,n){var r=T.a.stringify(Object(Y.a)({},T.a.parse(t.search),{page:n/10+1}));a.push("/?".concat(r))},u=i?"".concat(i.length," ").concat(1===i.length?"case":"cases"," found"):"Counting cases...",m=G().urlPage,s=function(){return r.a.createElement(ee.a,{limit:10,offset:10*(m-1),total:i?i.length:10*m,onClick:o})};return r.a.createElement(f.a,{container:!0,spacing:24},r.a.createElement(f.a,{item:!0,xs:12,container:!0,justify:"space-between",alignItems:"center"},r.a.createElement(f.a,{item:!0},r.a.createElement(s,null)),r.a.createElement(f.a,{item:!0},r.a.createElement(p.a,{variant:"body1"},u))),r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(function(){return l?r.a.createElement(p.a,{variant:"h5"},"Error: ",l.message):null===c?r.a.createElement(p.a,{variant:"h5"},"Loading..."):0===c.length?r.a.createElement(p.a,{variant:"h5"},"No results"):r.a.createElement(f.a,{container:!0,spacing:24,direction:"column"},c.map(function(e){return r.a.createElement(f.a,{item:!0,key:e.id},r.a.createElement(K,{incident:e}))}))},null)),r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(s,null)))}),ne=function(){return r.a.createElement(v,null,r.a.createElement(f.a,{container:!0,spacing:24},r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(y,null)),r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(X,null)),r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(ae,null))))},re=function(e){return r.a.createElement(o.b,Object.assign({to:"/"},e))},ce=function(){return r.a.createElement(v,null,r.a.createElement(I.a,{variant:"h1",gutterBottom:!0},"Page not found"),r.a.createElement(C.a,{component:re,variant:"body1"},"Go to main page"))},ie=Object(l.withStyles)({"@global body":{overflowY:"overlay"}})(function(){return r.a.createElement(J.c,null,r.a.createElement(J.a,{path:"/",exact:!0,component:ne}),r.a.createElement(J.a,{path:"/case/:id",component:B}),r.a.createElement(J.a,{component:ce}))}),le=Object(l.createMuiTheme)({typography:{useNextVariants:!0}});i.a.render(r.a.createElement(o.a,null,r.a.createElement(l.MuiThemeProvider,{theme:le},r.a.createElement(u.b,{utils:m.a},r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,null),r.a.createElement(ie,null))))),document.getElementById("root"))}},[[225,1,2]]]);
//# sourceMappingURL=main.65bf8bce.chunk.js.map