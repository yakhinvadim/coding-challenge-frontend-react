(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{145:function(e,t,a){e.exports=a.p+"static/media/logo.f958e91a.png"},151:function(e,t,a){e.exports=a.p+"static/media/bike.b4758c72.svg"},226:function(e,t,a){e.exports=a(385)},385:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(25),i=a.n(c),l=a(13),o=a(39),u=a(78),s=a(153),m=a(77),d=a.n(m),g=a(18),f=a.n(g),p=a(42),h=a(145),b=a.n(h),E=Object(l.createStyles)({header:{display:"flex",alignItems:"center"},logo:{width:150,height:150,marginRight:24}}),y=Object(l.withStyles)(E)(function(e){var t=e.classes;return r.a.createElement("header",{className:t.header},r.a.createElement("a",{href:"/coding-challenge-frontend-react/"},r.a.createElement("img",{src:b.a,alt:"Logo",className:t.logo})),r.a.createElement("div",null,r.a.createElement(p.a,{variant:"h3",gutterBottom:!0},"Police Department of Berlin"),r.a.createElement(p.a,{variant:"h5"},"Stolen Bikes")))}),j=Object(l.createStyles)({wrapper:{minWidth:800,maxWidth:1e3,margin:"0 auto",padding:20}}),v=Object(l.withStyles)(j)(function(e){var t=e.classes,a=e.children;return r.a.createElement("div",{className:t.wrapper},a)}),O=a(35),x=a.n(O),w=a(111),S=a(23),k=a.n(S),C=a(52),T=a.n(C),F=function(e){return new Date(1e3*e).toLocaleString([],{minute:"numeric",year:"numeric",month:"long",day:"numeric",hour:"numeric"})},I=Object(l.withStyles)(function(e){return Object(l.createStyles)({cardContent:{flex:"auto",display:"flex",flexDirection:"column",padding:2*e.spacing.unit},cardFooter:{marginTop:"auto",alignSelf:"flex-end",fontStyle:"italic"}})})(function(e){var t=e.incident,a=e.withLink,n=e.classes;return r.a.createElement("div",{className:n.cardContent},a?r.a.createElement(T.a,{component:function(e){return r.a.createElement(o.b,Object.assign({to:"/case/".concat(t.id)},e))},variant:"h6",gutterBottom:!0},t.title):r.a.createElement(k.a,{variant:"h6",gutterBottom:!0},t.title||"Loading..."),r.a.createElement(k.a,{variant:"body1",gutterBottom:!0},t.description||"No description"),r.a.createElement(k.a,{variant:"body1",gutterBottom:!0},t.occurred_at&&t.address?"".concat(F(t.occurred_at)," \u2014 ").concat(t.address):"..."),r.a.createElement(k.a,{variant:"caption",className:n.cardFooter},t.updated_at?"Reported: ".concat(F(t.updated_at)):"..."))}),_="https://bikewise.org:443/api/v2",N=a(11),D=a(29),P=a.n(D),L=(a(130),function(e){var t=Object(n.useState)({title:"Loading..."}),a=Object(N.a)(t,2),r=a[0],c=a[1],i=Object(n.useState)({}),l=Object(N.a)(i,2),o=l[0],u=l[1],s=Object(n.useState)({}),m=Object(N.a)(s,2),d=m[0],g=m[1],f=Object(n.useState)(null),p=Object(N.a)(f,2),h=p[0],b=p[1];return Object(n.useEffect)(function(){var t=new AbortController,a=t.signal;return fetch("".concat(_,"/incidents/").concat(e),{signal:a}).then(function(e){return e.json()}).then(function(e){var t=e.incident;return c(t),fetch("".concat(_,"/locations?").concat(P.a.stringify({occurred_before:t.occurred_at,occurred_after:t.occurred_at,incident_type:"theft",query:t.title})),{signal:a})}).then(function(e){return e.json()}).then(function(e){return e.features[0].geometry.coordinates}).then(function(e){u({zoom:10,longitude:e[0],latitude:e[1]}),g({longitude:e[0],latitude:e[1]})}).catch(b),function(){t.abort()}},[]),{incident:r,viewport:o,setViewport:u,pinCoordinates:d,error:h}}),B=function(e){var t=e.incidentId,a=L(t),n=a.incident,c=a.viewport,i=a.setViewport,l=a.pinCoordinates,o=a.error;return r.a.createElement(x.a,null,o?r.a.createElement(I,{incident:{title:"Error: ".concat(o.message)}}):r.a.createElement(I,{incident:n}),c.latitude&&c.longitude&&l.latitude&&l.longitude?r.a.createElement(w.b,Object.assign({mapStyle:"mapbox://styles/mapbox/streets-v11",width:"100%",height:400,mapboxApiAccessToken:"pk.eyJ1IjoieWFraGludmFkaW0iLCJhIjoiY2p0eDJ2bDk3MmVleDRkbXN3bjV2enk4ZyJ9.UuTPJrkGfk0WrX59JPHu8w",onViewportChange:function(e){return i(e)}},c),r.a.createElement(w.a,{latitude:l.latitude,longitude:l.longitude,offsetLeft:-6,offsetTop:-11},r.a.createElement("div",null,"\ud83d\udccd"))):r.a.createElement("div",{style:{height:400,backgroundColor:"#EFE9E1"}}))},Q=function(e){var t=e.match;return r.a.createElement(v,null,r.a.createElement(f.a,{container:!0,spacing:24},r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(y,null)),r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(B,{incidentId:t.params.id}))))},J=a(149),W=a(36),V=a(53),A=a.n(V),M=a(31),q=a.n(M),G=a(386),R=function(){var e=P.a.parse(location.search),t="string"===typeof e.page?parseInt(e.page):1,a="string"===typeof e.dateFrom?Object(G.a)(parseInt(e.dateFrom)):null,n="string"===typeof e.dateTo?Object(G.a)(parseInt(e.dateTo)):null;return{urlTextQuery:"string"===typeof e.textQuery?e.textQuery:"",urlDateFrom:a,urlDateTo:n,urlPage:t}},z=a(387),H=function(e){var t=e.dateFrom,a=e.dateTo,n=e.textQuery,r={};return t&&(r.dateFrom=Object(z.a)(t).toString()),a&&(r.dateTo=Object(z.a)(a).toString()),n&&(r.textQuery=n),P.a.stringify(r)},X=Object(l.createStyles)({datePicker:{minHeight:80},button:{marginTop:12}}),Y=Object(l.withStyles)(X)(Object(W.e)(function(e){var t=e.history,a=e.classes,c=R(),i=c.urlTextQuery,l=c.urlDateFrom,o=c.urlDateTo,s=Object(n.useState)(i),m=Object(N.a)(s,2),d=m[0],g=m[1],p=Object(n.useState)(l),h=Object(N.a)(p,2),b=h[0],E=h[1],y=Object(n.useState)(o),j=Object(N.a)(y,2),v=j[0],O=j[1],x=function(e){var t=e.value,n=e.onChange,c=Object(J.a)(e,["value","onChange"]);return r.a.createElement(u.a,Object.assign({clearable:!0,autoOk:!0,disableFuture:!0,keyboard:!0,className:a.datePicker,format:"dd.MM.yyyy",mask:function(e){return e?[/\d/,/\d/,".",/\d/,/\d/,".",/\d/,/\d/,/\d/,/\d/]:[]},value:t,onChange:n},c))};return r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),i===d&&l===b&&o===v||t.push("/?".concat(H({textQuery:d,dateFrom:b,dateTo:v})))}},r.a.createElement(f.a,{container:!0,spacing:24,alignItems:"flex-start",justify:"space-between"},r.a.createElement(f.a,{item:!0,xs:4},r.a.createElement(A.a,{id:"text-query",label:"Search case descriptions",value:d,onChange:function(e){g(e.target.value)},placeholder:"Cannondale",fullWidth:!0})),r.a.createElement(f.a,{item:!0,xs:!0},r.a.createElement(x,{value:b,onChange:E,label:"From",placeholder:"31.12.2017",maxDate:v})),r.a.createElement(f.a,{item:!0,xs:!0},r.a.createElement(x,{value:v,onChange:O,label:"To",placeholder:"31.12.2018",minDate:b})),r.a.createElement(f.a,{item:!0,xs:!0},r.a.createElement(q.a,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,className:a.button},"Find Cases"))))})),U=a(63),Z=a(151),K=a.n(Z),$=Object(l.withStyles)(function(e){return Object(l.createStyles)({imageContainer:{width:200,height:200,flex:"none",backgroundImage:"url(".concat(K.a,")"),backgroundSize:200},image:{height:"100%"},card:{display:"flex"}})})(function(e){var t=e.incident,a=e.classes;return r.a.createElement(x.a,{className:a.card},r.a.createElement("div",{className:a.imageContainer},t.media.image_url_thumb&&r.a.createElement("img",{src:t.media.image_url_thumb,className:a.image})),r.a.createElement(I,{incident:t,withLink:!0}))}),ee=a(152),te=a.n(ee),ae=function(){var e=Object(n.useState)(null),t=Object(N.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(null),i=Object(N.a)(c,2),l=i[0],o=i[1],u=Object(n.useState)(null),s=Object(N.a)(u,2),m=s[0],d=s[1],g=P.a.parse(location.search),f=R().urlPage;return Object(n.useEffect)(function(){var e={incident_type:"theft",proximity:"London",query:g.textQuery,occurred_after:g.dateFrom,occurred_before:g.dateTo},t=Object(U.a)({},e,{per_page:10,page:f}),a=Object(U.a)({},e,{per_page:1e6,page:1}),n=new AbortController,c=n.signal,i=function(e){return fetch("".concat(_,"/incidents?").concat(P.a.stringify(e)),{signal:c}).then(function(e){return e.json()}).then(function(e){return e.incidents}).catch(d)};return r(null),o(null),d(null),i(t).then(r),i(a).then(o),function(){n.abort()}},[g.textQuery,g.dateFrom,g.dateTo]),Object(n.useEffect)(function(){l&&l.length&&r(l.slice(10*(f-1),10*f))},[f,l]),{pageIncidents:a,setPageIncidents:r,allIncidents:l,setAllIncidents:o,error:m}},ne=Object(W.e)(function(e){var t=e.location,a=e.history,n=ae(),c=n.pageIncidents,i=n.allIncidents,l=n.error,o=function(e,n){var r=P.a.stringify(Object(U.a)({},P.a.parse(t.search),{page:n/10+1}));a.push("/?".concat(r))},u=i?"".concat(i.length," ").concat(1===i.length?"case":"cases"," found"):"Counting cases...",s=R().urlPage,m=function(){return r.a.createElement(te.a,{limit:10,offset:10*(s-1),total:i?i.length:10*s,onClick:o})},d=function(){return r.a.createElement(f.a,{item:!0,xs:12,container:!0,justify:"space-between",alignItems:"center"},r.a.createElement(f.a,{item:!0},r.a.createElement(m,null)),r.a.createElement(f.a,{item:!0},r.a.createElement(p.a,{variant:"body1"},u)))};return r.a.createElement(f.a,{container:!0,spacing:24},r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(d,null)),r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(function(){return l?r.a.createElement(p.a,{variant:"h5"},"Error: ",l.message):null===c?r.a.createElement(p.a,{variant:"h5"},"Loading..."):0===c.length?r.a.createElement(p.a,{variant:"h5"},"No results"):r.a.createElement(f.a,{container:!0,spacing:24,direction:"column"},c.map(function(e){return r.a.createElement(f.a,{item:!0,key:e.id},r.a.createElement($,{incident:e}))}))},null)),r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(d,null)))}),re=function(){return r.a.createElement(v,null,r.a.createElement(f.a,{container:!0,spacing:24},r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(y,null)),r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(Y,null)),r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(ne,null))))},ce=function(e){return r.a.createElement(o.b,Object.assign({to:"/"},e))},ie=function(){return r.a.createElement(v,null,r.a.createElement(k.a,{variant:"h1",gutterBottom:!0},"Page not found"),r.a.createElement(T.a,{component:ce,variant:"body1"},"Go to main page"))},le=Object(l.withStyles)({"@global body":{overflowY:"overlay"}})(function(){return r.a.createElement(W.c,null,r.a.createElement(W.a,{path:"/",exact:!0,component:re}),r.a.createElement(W.a,{path:"/case/:id",component:Q}),r.a.createElement(W.a,{component:ie}))}),oe=Object(l.createMuiTheme)({typography:{useNextVariants:!0}});i.a.render(r.a.createElement(o.a,{basename:"/coding-challenge-frontend-react/"},r.a.createElement(l.MuiThemeProvider,{theme:oe},r.a.createElement(u.b,{utils:s.a},r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,null),r.a.createElement(le,null))))),document.getElementById("root"))}},[[226,1,2]]]);
//# sourceMappingURL=main.511bd2d4.chunk.js.map